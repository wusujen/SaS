package com.christine.cart.sqlite;

import java.io.IOException;
import java.util.List;

import com.christine.cart.R;

import android.app.Activity;
import android.content.Intent;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.os.Bundle;
import android.util.Log;
import android.widget.TextView;

public class AddAccountActivity extends Activity {

	/** Called when the activity is first created. */
	@Override
	public void onCreate(Bundle savedInstanceState) {
	    super.onCreate(savedInstanceState);
	    
    	//Retrieve information from the passed Bundle to 
  		//get user information and display it
  		Bundle userInfo = getIntent().getExtras();
  	    if(userInfo==null){
  	    	return;
  	    }
  	    else{
  		    String username = userInfo.getString("username");
  		    String password = userInfo.getString("password");
  		    
  		    if(username!=null && password!=null){
  		    
  		    //TESTING SQLite
  		        AccountDatabaseHelper db = new AccountDatabaseHelper(this);
  		        
  		        try {
  		        	db.createDataBase();
  			 	} catch (IOException ioe) {
  			 		Intent createDatabaseFail = new Intent();
  			 		createDatabaseFail.putExtra("fail", "Database creation failed. Please try again");
  			 		setResult(RESULT_CANCELED,createDatabaseFail);
  			 		finish();
  			 		//throw new Error("Unable to create database");
  			 	}
  		        //OPEN THE DATABASE
  			 	try {
  			 		//myDbHelper.close();
  			 		db.openDataBase();
  			 	} catch(SQLException sqle){
  			 		Intent openDatabaseFail = new Intent();
  			 		openDatabaseFail.putExtra("fail", "Database failed to open. Please try again");
  			 		setResult(RESULT_CANCELED,openDatabaseFail);
  			 		finish();
  			 		//throw sqle;
  			 	}
  			 	
  		        /**
  		         * CRUD Operations
  		         * */
  		        //Inserting User Information
  		        Log.d("Insert: ", "Inserting ..");
  		        db.addAccount(new Account(username, password));
  		 
  		        // Reading all contacts
  		        Log.d("Reading: ", "Getting user account...");
  		        Account account = getAccount(username);    
  		 
  		       for (Account act : accounts) {
  		            String log = "Id: "+act.getId()+" ,Name: " + act.getName() + " ,Password: " + act.getPassword();
  		                // Writing Contacts to log
  		            Log.d("Name: ", log);
  		       }
  		      //END TESTING  
  		    }    
  	    }
	}
}
